@model List<ProjectManagementSystem.Models.ProjectFile>

@{
    ViewData["Title"] = "Edit Project Files";
    var projectId = ViewBag.ProjectId;
    var projectName = ViewBag.ProjectName;
}

<h3 class="mb-4">Edit Files for Project: <span class="text-primary">@projectName</span></h3>

<form asp-action="EditGroup" method="post" enctype="multipart/form-data">
    <input type="hidden" name="Project_pkId" value="@projectId" />

    @for (int i = 0; i < Model.Count; i++)
    {
        <div class="border rounded p-3 mb-4 shadow-sm">
            <input type="hidden" name="updatedFiles[@i].ProjectFile_pkId" value="@Model[i].ProjectFile_pkId" />

            <div class="row mb-2">
                <div class="col-md-6">
                    <label class="form-label fw-bold">Current File</label><br />
                    <a href="@Model[i].FilePath" target="_blank">
                        @System.IO.Path.GetFileName(Model[i].FilePath)
                    </a>
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">Type</label>
                    <input class="form-control" value="@Model[i].FileType" readonly />
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">Size</label>
                    <input class="form-control" value="@(Model[i].FileSize / 1024) KB" readonly />
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold" for="newFile_@i">Replace File (optional)</label>
                <input type="file" name="NewFiles[@i]" id="newFile_@i" class="form-control" />
                <small class="text-muted">Leave empty to keep current file.</small>
            </div>

            <div class="mb-2">
                <label class="form-label fw-bold">Uploader</label>
                <input type="text" name="updatedFiles[@i].UploadedBy" class="form-control" value="@Model[i].UploadedBy" required />
            </div>
        </div>
    }

    <div class="d-flex gap-2">
        <button type="submit" class="btn btn-success">Save All Changes</button>
        <a asp-action="Index" class="btn btn-secondary">Cancel</a>
    </div>
</form>
